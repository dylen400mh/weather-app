(()=>{"use strict";const t=(()=>{const t=document.querySelector("input"),e=document.getElementById("location"),n=document.getElementById("temperature"),o=document.getElementById("condition"),i=document.getElementById("feels-like"),r=document.getElementById("humidity"),c=document.getElementById("wind"),a=document.getElementById("wind-direction"),d=document.getElementById("precipitation"),l=document.getElementById("last-updated"),u=document.getElementById("error"),m=document.getElementById("toggle-units");function s(){t.value=""}function p(t,e=""){t?(u.textContent=e,u.style.display="block"):u.style.display="none"}return{updateDisplay:function(t,u){var g;s(),p(!1),g=u,m.textContent="Metric"===g?"Imperial":"Metric";const y=t.current,{location:h}=t;e.textContent=`${h.name}, ${h.region}, ${h.country}`,o.textContent=y.condition.text,r.textContent=`Humidity: ${y.humidity}`,a.textContent=`Wind Direction: ${y.wind_dir}`,l.textContent=`Last Updated: ${y.last_updated}`,n.textContent="Metric"===u?`${y.temp_c} 째C`:`${y.temp_f} 째F`,c.textContent="Metric"===u?`Wind: ${y.wind_kph} kph`:`Wind: ${y.wind_mph} mph`,i.textContent="Metric"===u?`Feels Like: ${y.feelslike_c} 째C`:`Feels Like: ${y.feelslike_f} 째F`,d.textContent="Metric"===u?`Precipitation: ${y.precip_mm} mm`:`Precipitation: ${y.precip_in} in`},resetInput:s,toggleError:p}})(),e=function(){return new Promise(((t,e)=>{"geolocation"in navigator&&navigator.geolocation.getCurrentPosition((e=>{const{latitude:n,longitude:o}=e.coords;t([n,o])}),(t=>{e(t)}))}))},n=(()=>{const o=document.querySelector("form"),i=document.getElementById("current-location"),r=document.getElementById("toggle-units"),c=document.getElementById("location");let a="Metric";async function d(e){try{const t=await fetch(`https://api.weatherapi.com/v1/current.json?key=fda6ad22a48445cabbe213714230208&q=${e}`,{mode:"cors"});return await t.json()}catch(e){throw t.toggleError(!0,e.message),e}}return o.addEventListener("submit",(e=>{e.preventDefault();const n=e.target.querySelector("input").value;n&&d(n).then((e=>{try{t.updateDisplay(e,a)}catch{t.toggleError(!0,e.error.message)}}))})),i.addEventListener("click",(async()=>{const[o,i]=await e();n.getWeatherData(`${o},${i}`).then((e=>{t.updateDisplay(e,a)}))})),r.addEventListener("click",(()=>{a="Metric"===a?"Imperial":"Metric",n.getWeatherData(c.textContent).then((e=>{t.updateDisplay(e,a)}))})),{getWeatherData:d}})(),o=n;e().then((e=>{if(e){const[n,i]=[e[0],e[1]];o.getWeatherData(`${n},${i}`).then((e=>{t.updateDisplay(e,"Metric")}))}else o.getWeatherData("toronto").then((e=>{t.updateDisplay(e,"Metric")}))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUUsTUFFQSxFQUFJM0MsYUFBWSxFQUFNdUQsRUFBS2hCLE1BQU1yQyxRQUNuQyxJQUVKLElBR0Z3QyxFQUFzQlEsaUJBQWlCLFNBQVNOLFVBQzlDLE1BQU9SLEVBQVVDLFNBQW1CLElBRXBDRyxFQUFJSyxlQUFlLEdBQUdULEtBQVlDLEtBQWFpQixNQUFNQyxJQUNuRCxFQUFJakQsY0FBY2lELEVBQU1aLEVBQU0sR0FDOUIsSUFHSjlDLEVBQWtCcUQsaUJBQWlCLFNBQVMsS0EzQzFDUCxFQUFrQixXQUFWQSxFQUFxQixXQUFhLFNBNkMxQ0gsRUFBSUssZUFBZWpDLEVBQVNULGFBQWFtRCxNQUFNQyxJQUM3QyxFQUFJakQsY0FBY2lELEVBQU1aLEVBQU0sR0FDOUIsSUFHRyxDQUFFRSxpQkFDVixFQTlEVyxHQWdFWixJQzlEQSxJQUEwQlMsTUFBTUUsSUFFOUIsR0FBSUEsRUFBYSxDQUNmLE1BQU9wQixFQUFVQyxHQUFhLENBQUNtQixFQUFZLEdBQUlBLEVBQVksSUFFM0QsRUFBSVgsZUFBZSxHQUFHVCxLQUFZQyxLQUFhaUIsTUFBTUMsSUFDbkQsRUFBSWpELGNBQWNpRCxFQUFNLFNBQVMsR0FFckMsTUFDRSxFQUFJVixlQUFlLFdBQVdTLE1BQU1DLElBQ2xDLEVBQUlqRCxjQUFjaUQsRUFBTSxTQUFTLEdBRXJDLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWF0aGVyLWFwcC8uL3NyYy9kb20uanMiLCJ3ZWJwYWNrOi8vd2VhdGhlci1hcHAvLi9zcmMvbG9jYXRpb24uanMiLCJ3ZWJwYWNrOi8vd2VhdGhlci1hcHAvLi9zcmMvYXBwLmpzIiwid2VicGFjazovL3dlYXRoZXItYXBwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IERPTSA9ICgoKSA9PiB7XHJcbiAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRcIik7XHJcbiAgY29uc3QgbG9jYXRpb25Db250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvY2F0aW9uXCIpO1xyXG4gIGNvbnN0IHRlbXBlcmF0dXJlQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0ZW1wZXJhdHVyZVwiKTtcclxuICBjb25zdCBjb25kaXRpb25Db250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbmRpdGlvblwiKTtcclxuICBjb25zdCBmZWVsc0xpa2VDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZlZWxzLWxpa2VcIik7XHJcbiAgY29uc3QgaHVtaWRpdHlDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImh1bWlkaXR5XCIpO1xyXG4gIGNvbnN0IHdpbmRDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIndpbmRcIik7XHJcbiAgY29uc3Qgd2luZERpcmVjdGlvbkNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2luZC1kaXJlY3Rpb25cIik7XHJcbiAgY29uc3QgcHJlY2lwaXRhdGlvbkNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJlY2lwaXRhdGlvblwiKTtcclxuICBjb25zdCBsYXN0VXBkYXRlZENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibGFzdC11cGRhdGVkXCIpO1xyXG4gIGNvbnN0IGVycm9yTWVzc2FnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXJyb3JcIik7XHJcbiAgY29uc3QgdG9nZ2xlVW5pdHNCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvZ2dsZS11bml0c1wiKTtcclxuXHJcbiAgZnVuY3Rpb24gcmVzZXRJbnB1dCgpIHtcclxuICAgIGlucHV0LnZhbHVlID0gXCJcIjtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHRvZ2dsZUVycm9yKHNob3dFcnJvciwgbWVzc2FnZSA9IFwiXCIpIHtcclxuICAgIGlmIChzaG93RXJyb3IpIHtcclxuICAgICAgZXJyb3JNZXNzYWdlLnRleHRDb250ZW50ID0gbWVzc2FnZTtcclxuICAgICAgZXJyb3JNZXNzYWdlLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBlcnJvck1lc3NhZ2Uuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY2xlYXJGaWVsZHMoKSB7XHJcbiAgICByZXNldElucHV0KCk7XHJcbiAgICB0b2dnbGVFcnJvcihmYWxzZSk7XHJcbiAgfVxyXG5cclxuICAvLyB0b2dnbGUgdW5pdHMgYnV0dG9uIHRleHQgc2hvdWxkIGJlIG9wcG9zaXRlIHRvIHdoYXQgaXMgY3VycmVudGx5IHNlbGVjdGVkXHJcbiAgZnVuY3Rpb24gc2V0VG9nZ2xlVW5pdHNCdXR0b25UZXh0KHNlbGVjdGVkVW5pdCkge1xyXG4gICAgdG9nZ2xlVW5pdHNCdXR0b24udGV4dENvbnRlbnQgPVxyXG4gICAgICBzZWxlY3RlZFVuaXQgPT09IFwiTWV0cmljXCIgPyBcIkltcGVyaWFsXCIgOiBcIk1ldHJpY1wiO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gdXBkYXRlRGlzcGxheSh3ZWF0aGVyRGF0YSwgdW5pdCkge1xyXG4gICAgLy8gY2xlYXIgZXhpc3RpbmcgZmllbGRzXHJcbiAgICBjbGVhckZpZWxkcygpO1xyXG5cclxuICAgIC8vIHVwZGF0ZSB0b2dnbGUgdW5pdHMgYnV0dG9uXHJcbiAgICBzZXRUb2dnbGVVbml0c0J1dHRvblRleHQodW5pdCk7XHJcblxyXG4gICAgY29uc3Qgd2VhdGhlciA9IHdlYXRoZXJEYXRhLmN1cnJlbnQ7XHJcbiAgICBjb25zdCB7IGxvY2F0aW9uIH0gPSB3ZWF0aGVyRGF0YTtcclxuXHJcbiAgICBsb2NhdGlvbkNvbnRhaW5lci50ZXh0Q29udGVudCA9IGAke2xvY2F0aW9uLm5hbWV9LCAke2xvY2F0aW9uLnJlZ2lvbn0sICR7bG9jYXRpb24uY291bnRyeX1gO1xyXG4gICAgY29uZGl0aW9uQ29udGFpbmVyLnRleHRDb250ZW50ID0gd2VhdGhlci5jb25kaXRpb24udGV4dDtcclxuICAgIGh1bWlkaXR5Q29udGFpbmVyLnRleHRDb250ZW50ID0gYEh1bWlkaXR5OiAke3dlYXRoZXIuaHVtaWRpdHl9YDtcclxuICAgIHdpbmREaXJlY3Rpb25Db250YWluZXIudGV4dENvbnRlbnQgPSBgV2luZCBEaXJlY3Rpb246ICR7d2VhdGhlci53aW5kX2Rpcn1gO1xyXG4gICAgbGFzdFVwZGF0ZWRDb250YWluZXIudGV4dENvbnRlbnQgPSBgTGFzdCBVcGRhdGVkOiAke3dlYXRoZXIubGFzdF91cGRhdGVkfWA7XHJcblxyXG4gICAgdGVtcGVyYXR1cmVDb250YWluZXIudGV4dENvbnRlbnQgPVxyXG4gICAgICB1bml0ID09PSBcIk1ldHJpY1wiID8gYCR7d2VhdGhlci50ZW1wX2N9IMKwQ2AgOiBgJHt3ZWF0aGVyLnRlbXBfZn0gwrBGYDtcclxuXHJcbiAgICB3aW5kQ29udGFpbmVyLnRleHRDb250ZW50ID1cclxuICAgICAgdW5pdCA9PT0gXCJNZXRyaWNcIlxyXG4gICAgICAgID8gYFdpbmQ6ICR7d2VhdGhlci53aW5kX2twaH0ga3BoYFxyXG4gICAgICAgIDogYFdpbmQ6ICR7d2VhdGhlci53aW5kX21waH0gbXBoYDtcclxuXHJcbiAgICBmZWVsc0xpa2VDb250YWluZXIudGV4dENvbnRlbnQgPVxyXG4gICAgICB1bml0ID09PSBcIk1ldHJpY1wiXHJcbiAgICAgICAgPyBgRmVlbHMgTGlrZTogJHt3ZWF0aGVyLmZlZWxzbGlrZV9jfSDCsENgXHJcbiAgICAgICAgOiBgRmVlbHMgTGlrZTogJHt3ZWF0aGVyLmZlZWxzbGlrZV9mfSDCsEZgO1xyXG5cclxuICAgIHByZWNpcGl0YXRpb25Db250YWluZXIudGV4dENvbnRlbnQgPVxyXG4gICAgICB1bml0ID09PSBcIk1ldHJpY1wiXHJcbiAgICAgICAgPyBgUHJlY2lwaXRhdGlvbjogJHt3ZWF0aGVyLnByZWNpcF9tbX0gbW1gXHJcbiAgICAgICAgOiBgUHJlY2lwaXRhdGlvbjogJHt3ZWF0aGVyLnByZWNpcF9pbn0gaW5gO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHsgdXBkYXRlRGlzcGxheSwgcmVzZXRJbnB1dCwgdG9nZ2xlRXJyb3IgfTtcclxufSkoKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IERPTTtcclxuIiwiY29uc3QgTG9jYXRpb24gPSAoKCkgPT4ge1xyXG4gIGZ1bmN0aW9uIGdldENvb3JkaW5hdGVzKCkge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgaWYgKFwiZ2VvbG9jYXRpb25cIiBpbiBuYXZpZ2F0b3IpIHtcclxuICAgICAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKFxyXG4gICAgICAgICAgKHBvc2l0aW9uKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIFJldHJpZXZlIHRoZSBsYXRpdHVkZSBhbmQgbG9uZ2l0dWRlIGNvb3JkaW5hdGVzXHJcbiAgICAgICAgICAgIGNvbnN0IHsgbGF0aXR1ZGUsIGxvbmdpdHVkZSB9ID0gcG9zaXRpb24uY29vcmRzO1xyXG4gICAgICAgICAgICByZXNvbHZlKFtsYXRpdHVkZSwgbG9uZ2l0dWRlXSk7XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4geyBnZXRDb29yZGluYXRlcyB9O1xyXG59KSgpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgTG9jYXRpb247XHJcbiIsImltcG9ydCBET00gZnJvbSBcIi4vZG9tXCI7XHJcbmltcG9ydCBMb2NhdGlvbiBmcm9tIFwiLi9sb2NhdGlvblwiO1xyXG5cclxuY29uc3QgQXBwID0gKCgpID0+IHtcclxuICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImZvcm1cIik7XHJcbiAgY29uc3QgY3VycmVudExvY2F0aW9uQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjdXJyZW50LWxvY2F0aW9uXCIpO1xyXG4gIGNvbnN0IHRvZ2dsZVVuaXRzQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b2dnbGUtdW5pdHNcIik7XHJcbiAgY29uc3QgbG9jYXRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvY2F0aW9uXCIpO1xyXG5cclxuICAvLyB1bml0cyBhcmUgc2V0IGFzIG1ldHJpYyBieSBkZWZhdWx0XHJcbiAgbGV0IHVuaXRzID0gXCJNZXRyaWNcIjtcclxuXHJcbiAgLy8gdG9nZ2xlIHVuaXRzXHJcbiAgZnVuY3Rpb24gdG9nZ2xlVW5pdHMoKSB7XHJcbiAgICB1bml0cyA9IHVuaXRzID09PSBcIk1ldHJpY1wiID8gXCJJbXBlcmlhbFwiIDogXCJNZXRyaWNcIjtcclxuICB9XHJcblxyXG4gIC8vIGdldHMgd2VhdGhlciBkYXRhIGJhc2VkIG9uIGNpdHkvcHJvdmluY2UvY291bnRyeSBvciBjb29yZGluYXRlc1xyXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1zaGFkb3dcclxuICBhc3luYyBmdW5jdGlvbiBnZXRXZWF0aGVyRGF0YShsb2NhdGlvbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcclxuICAgICAgICBgaHR0cHM6Ly9hcGkud2VhdGhlcmFwaS5jb20vdjEvY3VycmVudC5qc29uP2tleT1mZGE2YWQyMmE0ODQ0NWNhYmJlMjEzNzE0MjMwMjA4JnE9JHtsb2NhdGlvbn1gLFxyXG4gICAgICAgIHsgbW9kZTogXCJjb3JzXCIgfVxyXG4gICAgICApO1xyXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICByZXR1cm4gZGF0YTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIERPTS50b2dnbGVFcnJvcih0cnVlLCBlcnJvci5tZXNzYWdlKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnN0IGlucHV0ID0gZS50YXJnZXQucXVlcnlTZWxlY3RvcihcImlucHV0XCIpLnZhbHVlO1xyXG4gICAgaWYgKGlucHV0KSB7XHJcbiAgICAgIGdldFdlYXRoZXJEYXRhKGlucHV0KS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIC8vIHVwZGF0ZSBkaXNwbGF5XHJcbiAgICAgICAgICBET00udXBkYXRlRGlzcGxheShkYXRhLCB1bml0cyk7XHJcbiAgICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgICAvLyBkaXNwbGF5IGVycm9yIG1lc3NhZ2VcclxuICAgICAgICAgIERPTS50b2dnbGVFcnJvcih0cnVlLCBkYXRhLmVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGN1cnJlbnRMb2NhdGlvbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgW2xhdGl0dWRlLCBsb25naXR1ZGVdID0gYXdhaXQgTG9jYXRpb24uZ2V0Q29vcmRpbmF0ZXMoKTtcclxuXHJcbiAgICBBcHAuZ2V0V2VhdGhlckRhdGEoYCR7bGF0aXR1ZGV9LCR7bG9uZ2l0dWRlfWApLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgRE9NLnVwZGF0ZURpc3BsYXkoZGF0YSwgdW5pdHMpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIHRvZ2dsZVVuaXRzQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICB0b2dnbGVVbml0cygpO1xyXG4gICAgQXBwLmdldFdlYXRoZXJEYXRhKGxvY2F0aW9uLnRleHRDb250ZW50KS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIERPTS51cGRhdGVEaXNwbGF5KGRhdGEsIHVuaXRzKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4geyBnZXRXZWF0aGVyRGF0YSB9O1xyXG59KSgpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBwO1xyXG4iLCJpbXBvcnQgQXBwIGZyb20gXCIuL2FwcFwiO1xyXG5pbXBvcnQgRE9NIGZyb20gXCIuL2RvbVwiO1xyXG5pbXBvcnQgTG9jYXRpb24gZnJvbSBcIi4vbG9jYXRpb25cIjtcclxuXHJcbi8vIGdldCBjb29yZGluYXRlcyB1c2luZyBHZW9Mb2NhdGlvbiBBUEkgYW5kIHVzZSB0aG9zZSBjb29yZHMgdG8gc2V0IGRlZmF1bHQgbG9jYXRpb24gb24gcGFnZSBsb2FkICh1bml0cyB3aWxsIGJlIG1ldHJpYyBvbiBkZWZhdWx0KVxyXG5Mb2NhdGlvbi5nZXRDb29yZGluYXRlcygpLnRoZW4oKGNvb3JkaW5hdGVzKSA9PiB7XHJcbiAgLy8gaWYgY29vcmRpbmF0ZXMgd2VyZSBmb3VuZCwgc2VhcmNoIHdpdGggdGhlbSwgb3RoZXJ3aXNlLCBzZWFyY2ggZm9yIGEgJ2RlZmF1bHQnIGxvY2F0aW9uXHJcbiAgaWYgKGNvb3JkaW5hdGVzKSB7XHJcbiAgICBjb25zdCBbbGF0aXR1ZGUsIGxvbmdpdHVkZV0gPSBbY29vcmRpbmF0ZXNbMF0sIGNvb3JkaW5hdGVzWzFdXTtcclxuXHJcbiAgICBBcHAuZ2V0V2VhdGhlckRhdGEoYCR7bGF0aXR1ZGV9LCR7bG9uZ2l0dWRlfWApLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgRE9NLnVwZGF0ZURpc3BsYXkoZGF0YSwgXCJNZXRyaWNcIik7XHJcbiAgICB9KTtcclxuICB9IGVsc2Uge1xyXG4gICAgQXBwLmdldFdlYXRoZXJEYXRhKFwidG9yb250b1wiKS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIERPTS51cGRhdGVEaXNwbGF5KGRhdGEsIFwiTWV0cmljXCIpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuIl0sIm5hbWVzIjpbImlucHV0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwibG9jYXRpb25Db250YWluZXIiLCJnZXRFbGVtZW50QnlJZCIsInRlbXBlcmF0dXJlQ29udGFpbmVyIiwiY29uZGl0aW9uQ29udGFpbmVyIiwiZmVlbHNMaWtlQ29udGFpbmVyIiwiaHVtaWRpdHlDb250YWluZXIiLCJ3aW5kQ29udGFpbmVyIiwid2luZERpcmVjdGlvbkNvbnRhaW5lciIsInByZWNpcGl0YXRpb25Db250YWluZXIiLCJsYXN0VXBkYXRlZENvbnRhaW5lciIsImVycm9yTWVzc2FnZSIsInRvZ2dsZVVuaXRzQnV0dG9uIiwicmVzZXRJbnB1dCIsInZhbHVlIiwidG9nZ2xlRXJyb3IiLCJzaG93RXJyb3IiLCJtZXNzYWdlIiwidGV4dENvbnRlbnQiLCJzdHlsZSIsImRpc3BsYXkiLCJ1cGRhdGVEaXNwbGF5Iiwid2VhdGhlckRhdGEiLCJ1bml0Iiwic2VsZWN0ZWRVbml0Iiwid2VhdGhlciIsImN1cnJlbnQiLCJsb2NhdGlvbiIsIm5hbWUiLCJyZWdpb24iLCJjb3VudHJ5IiwiY29uZGl0aW9uIiwidGV4dCIsImh1bWlkaXR5Iiwid2luZF9kaXIiLCJsYXN0X3VwZGF0ZWQiLCJ0ZW1wX2MiLCJ0ZW1wX2YiLCJ3aW5kX2twaCIsIndpbmRfbXBoIiwiZmVlbHNsaWtlX2MiLCJmZWVsc2xpa2VfZiIsInByZWNpcF9tbSIsInByZWNpcF9pbiIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwibmF2aWdhdG9yIiwiZ2VvbG9jYXRpb24iLCJnZXRDdXJyZW50UG9zaXRpb24iLCJwb3NpdGlvbiIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiY29vcmRzIiwiZXJyb3IiLCJBcHAiLCJmb3JtIiwiY3VycmVudExvY2F0aW9uQnV0dG9uIiwidW5pdHMiLCJhc3luYyIsImdldFdlYXRoZXJEYXRhIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1vZGUiLCJqc29uIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInRhcmdldCIsInRoZW4iLCJkYXRhIiwiY29vcmRpbmF0ZXMiXSwic291cmNlUm9vdCI6IiJ9